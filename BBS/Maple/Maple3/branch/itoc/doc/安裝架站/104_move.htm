
<!-- banner start -->
<script language=JavaScript src=http://home.pchome.com.tw/js/banner.js></script>
<!-- banner end -->
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=big5">
<meta http-equiv=Content-Language content=zh-tw>
<title>MapleBBS 說明文件</title>
</head>

<body>

<center><table><tr><td><pre>

                       <font color="#008000">★ 快速移機手冊 ★</font>

  <a href='#1'>一、安裝作業系統</a>
  <a href='#2'>二、壓縮原來的 BBS</a>
  <a href='#3'>三、建立 BBS 帳號</a>
  <a href='#4'>四、安裝 BBS</a>
  <a href='#51'>五、設定 BBS 環境 -- （Ａ）如果有 inetd【FreeBSD】</a>
  <a href='#52'>五、設定 BBS 環境 -- （Ｂ）如果有 xinetd【Linux】</a>
  <a href='#53'>五、設定 BBS 環境 -- （Ｃ）如果沒有 inetd/xinetd</a>
  <a href='#6'>六、其他設定</a>
  <a href='#7'>七、享用您自己的 BBS</a>


    本文件是寫給要安裝 itoc 所維護的 bbs 程式版本所使用的，並不適用
  其他 bbs 版本。

  <a name='1'></a>
  <font color="#000080"><u>一、安裝作業系統</u></font>

    本程式已證明在 FreeBSD 及 Linux 都可以運作正常，其他系統我沒有
  試過，所以不清楚。

    安裝作業系統時就像平常安裝一樣，沒什麼特別要注意的，唯一要提醒
  您的是，請安裝 sed lynx nawk 這三套程式，因為 bbs 會用到。

  <a name='2'></a>
  <font color="#000080"><u>二、壓縮原來的 BBS</u></font>

    以 bbs 身份登入舊機器。

  -bbs- % <font color="#0000FF">tar cfz /tmp/old-bbs.tgz /home/bbs</font>
          把舊機器上的 BBS 壓縮起來

  -bbs- % <font color="#0000FF">ftp xx.yy.zz</font>
          xx.yy.zz 是新機器，把 old-bbs.tgz upload 上去

    以下所有的指令都是在新機器上執行。

  <a name='3'>
  <font color="#000080"><u>三、建立 BBS 帳號</u></font>

    以 root 身份登入。

  -root- # <font color="#FF00FF">mkdir /home/bbs</font>

  -root- # <font color="#FF00FF">vipw</font>
           如果您是 FreeBSD 的話，在最後一行加上
           bbs:*:9999:99::0:0:BBS Administrator:/home/bbs:/bin/tcsh
           如果您是 Linux 的話，在最後一行加上
           bbs:x:9999:999:BBS Administrator:/home/bbs:/bin/tcsh
           (當然您也可以用 pw 或 useradd 的指令來完成相同的動作)

  -root- # <font color="#FF00FF">joe /etc/group</font>
           (假設編輯器是 joe，如果不是的話，請自行改變)
           如果您是 FreeBSD 的話，在最後一行加上
           bbs:*:99:bbs
           如果您是 Linux 的話，在最後一行加上
           bbs:*:999:bbs
           (當然您也可以用 pw 或 groupadd 的指令來完成相同的動作)

  -root- # <font color="#FF00FF">passwd bbs</font>
           輸入 bbs 的密碼

  -root- # <font color="#FF00FF">tar xfz /tmp/old-bbs.tgz -C /home/</font>
           假設您把舊機器的全站檔案放在 /tmp/old-bbs.tgz

  -root- # <font color="#FF00FF">chown -R bbs:bbs /home/bbs</font>

  <a name='4'></a>
  <font color="#000080"><u>四、安裝 BBS</u></font></font>

    以 bbs 身份登入。

  -bbs- % <font color="#0000FF">joe /home/bbs/src/include/config.h</font>
          修改 HOST_ALIASES，把您所有的 fqdn 都加進去

#define HOST_ALIASES    {MYHOSTNAME, MYIPADDR, \
                         "wolf.twbbs.org", "wolf.twbbs.org.tw", \
                         NULL}

          如果您是 Linux 的話，改 BBSGID 為 999

#define BBSGID          99                      /* Linux 請設為 999 */

          如果您是 FreeBSD 的話
          那麼 BBSGID 維持是 99

  -bbs- % <font color="#0000FF">crontab /home/bbs/doc/crontab</font>
          把 doc/crontab 的內容加入 crontab

  <a name='51'></a>
  <font color="#000080"><u>五、設定 BBS 環境 -- （Ａ）如果有 inetd</u></font>

    如果沒有 /etc/inetd.conf 這檔案，請跳到五（Ｂ），通常 FreeBSD 應該有
  inetd 才對。

    以 root 身份登入。

  -root- # <font color="#FF00FF">joe /etc/inetd.conf</font>
           刪除原本的二行 (前面加上 # 即可)
#telnet stream  tcp     nowait  root    /usr/libexec/telnetd    telnetd
#telnet stream  tcp6    nowait  root    /usr/libexec/telnetd    telnetd

           加入以下數行
#
# MapleBBS
#
telnet  stream  tcp     wait    bbs     /home/bbs/bin/bbsd      bbsd -i
finger  stream  tcp     wait    bbs     /home/bbs/bin/bguard    bguard -i
pop3    stream  tcp     wait    bbs     /home/bbs/bin/bpop3d    bpop3d -i
gopher  stream  tcp     wait    bbs     /home/bbs/bin/gemd      gemd -i
smtp    stream  tcp     wait    bbs     /home/bbs/bin/bmtad     bmtad -i
xchat   stream  tcp     wait    bbs     /home/bbs/bin/xchatd    xchatd -i
bbsnntp stream  tcp     wait    bbs     /home/bbs/innd/innbbsd  innbbsd -i

  -root- # <font color="#FF00FF">joe /etc/rc.d/rc.local</font>
           加入以下數行 (這檔案有可能原本是沒有任何文字的開新檔案)

#!/bin/sh
#
# MapleBBS
#
su bbs -c '/home/bbs/bin/camera'
su bbs -c '/home/bbs/bin/account'

  <a name='52'></a>
  <font color="#000080"><u>五、設定 BBS 環境 -- （Ｂ）如果有 xinetd</u></font>

    如果沒有 /etc/xinetd.d/ 這目錄，請跳到五（Ｃ），通常 Linux 應該有
  xinetd 才對。

    以 root 身份登入。

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/telnet</font>

service telnet
{
        disable         = no
        flags           = REUSE
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/bbsd
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/xchat</font>

service xchat
{
        disable         = no
        flags           = REUSE
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/xchatd
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/bbsnntp</font>

service bbsnntp
{
        disable         = no
        flags           = REUSE
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/innd/innbbsd
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/pop3</font>

service pop3
{
        disable         = no
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/bpop3d
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/finger</font>

service finger
{
        disable         = no
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/bguard
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/smtp</font>

service smtp
{
        disable         = no
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/bmtad
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/xinetd.d/gopher</font>

service gopher
{
        disable         = no
        flags           = REUSE
        socket_type     = stream
        wait            = yes
        user            = bbs
        server          = /home/bbs/bin/gemd
        server_args     = -i
}

  -root- # <font color="#FF00FF">joe /etc/rc.local</font>
           加入以下數行 (這檔案有可能原本是沒有任何文字的開新檔案)

#!/bin/sh
#
# MapleBBS
#
su bbs -c '/home/bbs/bin/camera'
su bbs -c '/home/bbs/bin/account'

  <a name='53'></a>
  <font color="#000080"><u>五、設定 BBS 環境 -- （Ｃ）如果沒有 inetd/xinetd</u></font>

    沒 inetd 也沒 xinetd，改用 standalone 啟動

    以 root 身份登入。

  -root- # <font color="#FF00FF">joe /etc/rc.local</font>
           加入以下數行 (這檔案有可能原本是沒有任何文字的開新檔案)

#!/bin/sh
#
# MapleBBS
#
/home/bbs/bin/bbsd
/home/bbs/bin/bmtad
/home/bbs/bin/bpop3d
/home/bbs/bin/gemd
/home/bbs/bin/bguard
/home/bbs/bin/xchatd
/home/bbs/innd/innbbsd

su bbs -c '/home/bbs/bin/camera'
su bbs -c '/home/bbs/bin/account'

  <a name='6'></a>
  <font color="#000080"><u>六、其他設定</u></font>

  以 root 身份登入。

  -root- # <font color="#FF00FF">joe /etc/services</font>
           加入以下數行

xchat           3838/tcp
xchat           3838/udp
bbsnntp         7777/tcp   usenet       #Network News Transfer Protocol
bbsnntp         7777/udp   usenet       #Network News Transfer Protocol

  -root- # <font color="#FF00FF">joe /etc/login.conf</font>
           修改 md5 為 des 編碼，Linux 請跳過此步驟

 default:\
        :passwd_format=des:\

  -root- # <font color="#FF00FF">joe /etc/rc.conf</font>
           把 YES 改成 NO，Linux 請跳過此步驟

sendmail_enable="NO"

  -root- # <font color="#FF00FF">reboot</font>
           重開機吧

  <a name='7'></a>
  <font color="#000080"><u>七、享用您自己的 BBS</u></font>

    您的 BBS 應該已經架好了，試著 telnet 看看，那就這樣好好享用吧。

--
                                                    交大電子 杜宇軒
                               E-Mail: <a href=mailto:itoc.bbs@bbs.tnfsh.tn.edu.tw>itoc.bbs@bbs.tnfsh.tn.edu.tw</a>

</pre></td></tr></table>

</body>
</html>
